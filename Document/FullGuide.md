# My Asisstent повниий гайд
---


## _Команди_  (**Command**)
---

Як і було вказано в кроткому гайду ця сторінка використовується для  додання команд трігерів та задання певної логіки для них.


![Загальний вигляд вікна:](https://github.com/MaksBerkutov/MyAsistentNew/blob/master/ImageGit/CodeProject.png)

Кнопка “*AddMenu*” використовується для виклику меню “_Додавання команд_”.
Розглянемо синтаксис виводу команд:

![синтаксис виводу команд:](https://github.com/MaksBerkutov/MyAsistentNew/blob/master/ImageGit/CodeProjectOutputInfo.png)

## Додавання команд
---

![Загальний вигляд вікна:](https://github.com/MaksBerkutov/MyAsistentNew/blob/master/ImageGit/CreateCommandBox.png)

Блок **Main** дає змогу керувати основними функціями як:
-	Додати команду тріггер.
-	Видалити (***Delete***) вибрану дію в ***AllCommand***.
-	Додати (***Add***) додати команду та дії для неї.
-	Закрити(***Close***) закрити вікно без збереження. 

Блок **Activity** це всі можливі дії на команду:
-	***Arduinos*** послати команду на ардуино.
![Вигляд вікна](https://github.com/MaksBerkutov/MyAsistentNew/blob/master/ImageGit/Arduinos.png)

1. тут будуть відображатись всі команди для ардуіно 
2.  тут буде потрібно вибрати плату зі списку всіх під’єднаних плат.
3.  зберегти. 
-	**ArduinoReadDate** май же те саме але ще отримуємо результат який буде промовляти програма.
![Вигляд вікна](https://github.com/MaksBerkutov/MyAsistentNew/blob/master/ImageGit/ArduinoReadDate.png)

В текстове поле потрібно написати текст який повинна промовити програма але замість значень які прийдуть з модуля треба написати назву змінної у `квадратних дужках`!
А також обрати плату і команду в правому боці так як і в  ***Arduinos***.
- ***Path*** запуск конкретної програми.

![Вигляд вікна](https://github.com/MaksBerkutov/MyAsistentNew/blob/master/ImageGit/Path.png)

В поле для вводу тексту можливо ввести путь до файлу або ж натиснути на кнопку `Pаth` яка відкриє файловий діалог для вибору файлу .

Перемикач “***Local Machine***” встановлю буде запускатися ця програма на комп’ютері на якому зараз встановлений сервер або ж на віддаленому комп’ютері.

-	***Keyboard*** створений для емуляції клавіатури.

![Вигляд вікна](https://github.com/MaksBerkutov/MyAsistentNew/blob/master/ImageGit/Keyboard1.png)

При натисканні на Row буде додаватися одна клітина по горизонталі. 

При натисканні на Cow буде додаватися одна клітина по вертикалі. 

Клавіші будуть об’єднуватися в клітини по горизонталі і йти далі поки не закінчяться елементи. Для додавання треба два рази клацнути по пустому полю, а після того як з’явиться текс `Read` натиснути на клавішу яку ви хочете записати нижче приклад.


![Вигляд вікна](https://github.com/MaksBerkutov/MyAsistentNew/blob/master/ImageGit/Keyboard2.png)
![Вигляд вікна](https://github.com/MaksBerkutov/MyAsistentNew/blob/master/ImageGit/Keyboard3.png)
![Вигляд вікна](https://github.com/MaksBerkutov/MyAsistentNew/blob/master/ImageGit/Keyboard4.png)

Для перезапису потрібно також клацнути два рази. Для видалення натиснути раз лівою кнопку миші.
- ***Script*** (У розробці)
- ***Voice*** використовуеться для озвучки асистентом.

![Вигляд вікна](https://github.com/MaksBerkutov/MyAsistentNew/blob/master/ImageGit/Voice.png)

Все просто, в текстове поле вводимо команду яку промовить асистент.

Якщо в тексті буде `$` то це отримати поточну дату. 

Якщо в тексті буде `@` то це отримати поточний час. 

## _Журнал_ (**Logs**)
---
Журнал введеться для збереження та фіксування основних помилок попереджень та меседжів. Являє собою щось накштаут консолі або термінала. Має функціонал для написання команд, але базові команди як були так і залишилися можливо з оновленням буде і підрамки більшої кількості програм.

![Вигляд вікна](https://github.com/MaksBerkutov/MyAsistentNew/blob/master/ImageGit/Logs.png)

Перший блок це дата та час, далі меседж після цього статус.

## _Скрипти_ (**Script**)
---

Дуже складний механізм, принципом якого є інтегрувати сторонній код в програму під час її виконання. У редакторі є блок Файл який має пункти :
-	`Новий проект` створення проекту.
-	`Відкрити проект` відкрити існуючий проект, а також показує 5 останніх створених файлів.
-	`Зберегти` збереження коду.

А також блок Отладка:
-	`Зібрати` спроба скомпілювати файл.
-	`Запустити` спроба запуска коду.

![Вигляд вікна](https://github.com/MaksBerkutov/MyAsistentNew/blob/master/ImageGit/Script.png)

![Вигляд вікна](https://github.com/MaksBerkutov/MyAsistentNew/blob/master/ImageGit/CreateScript.png)

## _Налаштування_ (**Settings**)
---

### _Головні налаштування_ (**Main**)

- Перший випадаючи список дає змогу вибрати язик для прослухування речі. 
- Другий дає змогу вибрати список для відтворення голосу. 
- Перший перемикач (Озвучивать логи) відповідає за чи буде промовляти записи з журналу. 
- Другий перемикач фактично робить теж саме але буде промовляти тільки меседжі.
- Список номер 5 вказується те яка фразу буде промовлятися (якщо ввімкнений перемикач) 
- Під полями 6 та 7 вказується час через який буду збереження та скількі сервер буде чекати відповіді від модуля (чим слабший зв'язок тим більше треба буде чекати). 

![Вигляд вікна](https://github.com/MaksBerkutov/MyAsistentNew/blob/master/ImageGit/Settings_Main.png)

### _Налаштування мережі_ (**Network**)

Блок “***Server Settings***” дозволяє налаштувати Ip адрес та порт на який будуть підключатися модулі та комп’ютери. Для коректного вибору Ip адресу скористайтеся командою `ipconfig` в консолі ось приклад:

![Вигляд вікна](https://github.com/MaksBerkutov/MyAsistentNew/blob/master/ImageGit/ipconfig.png)

В виводі шукаємо наш адаптер по якому відбувається підключення до мережі. І дивимось на **IPv4** адресу це і є наш Ip адрес в локальній мережі. Його і треба вказати у програмі.
Після вибору Ip адресу треба вписати порт він може бути будь яким але він повинен буду вільним.

Якщо у вас більше одного фізичного адаптера треба вибрати у випадючому списку коректний Ip адрес який збіжиться з консольним. 

![Вигляд вікна](https://github.com/MaksBerkutov/MyAsistentNew/blob/master/ImageGit/Settings_Network1.png)

![Вигляд вікна](https://github.com/MaksBerkutov/MyAsistentNew/blob/master/ImageGit/Settings_Network1.png)

Блок Мережеві налаштування (**Network Settings**). 

Нажаль в станом на 12.6.2023 _не_ _працює_ але в майбутньому дозволить створювати точку доступу до якої будуть підєднуватися модулі. Для цього треба буде ввести назву мережі (SSID) та пароль (PASWORLD).

### _Налаштування модулів_ (**Arduino**)

Все що дозволяє це переглянути всі підключенні плати, так їх команди (команди з припискою  `“_REC” ` кажуть про те що команда повертає якісь дані).

![Вигляд вікна](https://github.com/MaksBerkutov/MyAsistentNew/blob/master/ImageGit/Settings_Arduino.png)

### _Налаштування локального веб серверу_ (**Local Web Server**)
- Блок `“Log Web Server”` з назви вже зрозуміло що тут буде запустуватися журнал веб серверу .
- Блок `“Main Settings Web Server”`  головні налаштування веб серверу.
- Перший перемикач відповідає за ввімкнення та вимкнення веб серверу.
- Друге текстове поле це адреса серверу в мережі.
- Третє текстове поле це шлях до папки за сайтом (можливо завантажити або зробити самому інструкція до створення буде написана після завершення написання основного коду  ).

![Вигляд вікна](https://github.com/MaksBerkutov/MyAsistentNew/blob/master/ImageGit/Settings_LWS.png)
![Вигляд сайту](https://github.com/MaksBerkutov/MyAsistentNew/blob/master/ImageGit/Settings_LWS_Site.png)
![Bигляд сторінки сайту](https://github.com/MaksBerkutov/MyAsistentNew/blob/master/ImageGit/Settings_LWS_Site1.png)

### _Ін'єкції_ коду (**Inject**)
Ін’єкції коду дозволяють писати складні прикладні програми до серверу. Має базову зашиту від злому також дозволяє розширити функціонал асистента до безкінечності.

Що для цього потрібно:
-	Базові знання мови C#.
-	Створення профілю на сервері.
-	Стабільний зв'язок прикладної програми з сервером (краще за все запускати на тому ж пристрої на якому працює сервер ).
Самий простий сценарій це написати програму, скомпілювати . Шлях до скомпільованого файлу прописати на команду тріггер. Після того як користувач промовить команду сервер запустить файл вашого коду який під'єднаеться до серверу і виконає певні дії.

![Вигляд вікна](https://github.com/MaksBerkutov/MyAsistentNew/blob/master/ImageGit/Settings_Inject.png)

Перший перемикач вмикає та вимикає сервер. Другий перемикач дозволяє відкрити доступ до глибоких налаштувань які дають змогу встановити Ip та порт для під’єднання.
Далі два поля для уведення тексту за допомогою них та кнопки “***Add***” додаються нові профілі (на один профіль може під єднатися тільки одна прикладна програма після від’єднання програми профіль знову буде вільним). В першому полі вводиться  логін в іншому пароль.

Кнопка  “***Delete***” дозволяє видалити вибраний профіль в модулі “***All Users***”.

#### ***Бібліотека***

Для початку написання коду потрібно скачати бібліотеку з репозиторію проекту та додати його в ваш проект.
Прикладка створення підключення 
```csharp
var Worker = new Connector.Connector("admin", "admin").GetConnection().GetWorker();
```
В прикладі прикладна програма під'єднується до сервера на профіль за логіном та паролем “**admin**”.
Актуальний функціонал можливо подивитися в інструкції до ін’єкцій.

На даний момент є три функції :

- `void Voice(string VoiceToSpech)` Ця функція дозволяє заставити сервер промовити фрау яку ви напишете.
- `void SendArduino(string NamePlate, string Command)` Ця функція відправляє команду на модуль( для цього треба знати назву плати та команду все це вказується в прошивці до модуля).
- `AsistenetVariableManager SendArduinoRecive(string NamePlate, string Command)` Фактично робить теж саме але ще отримує відповідь. 

##### `AsistenetVariableManager` -  як отримати данні?

Всі данні приходять у вигляді тексту для того щоб отримати данні вам потрібно знати назву змінної яка теж вказується в прошивці. 

Ось приклад :
```csharp
var result = Worker.SendArduinoRecive("Arduino1", "LIGHT_REC");
                if (result["Status"].Value == "True") 
                    Worker.Voice("Свет в кухне включён");

```

В прикладі ми отримуємо відповідь з модуля далі отримуємо змінну   Status якщо вона має значення True то сервер промовить "Свет в кухне включён".

Повний приклад коду приведений нижче :

```csharp
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace ConsoleApp7
{
    internal class Program
    {
        static void Main(string[] args)
        {
            try
            {
                var Worker = new Connector.Connector("admin", "admin").
                                        GetConnection().
                                                        GetWorker();

                var result = Worker.SendArduinoRecive("Arduino1", "LIGHT_REC");
                if (result["Status"].Value == "True") 
                    Worker.Voice("Свет в кухне включён");
                
                Worker.Voice("Иньекция прошла успешно");
                while (true) { Worker.Voice(Console.ReadLine()); }
            }
            catch (Exception ex )
            {

                Console.WriteLine(ex.Message);
            }
            

        }
    }
}


```
## _Налаштування телеграм боту_ (**Telegram Settings**)
---

Телеграм бот використовується для налаштувань, отримання останніх записів в журналі, а також для емуляції команд тріггерів. 
Все що потрібно для його налаштування це токен який можливо отримати у телеграм боті [Bot Father]([xxx](https://t.me/BotFather)), а потім вписати його у текстове поле `Api Key`.

Після коректного запуску цього модуля в вашому телеграм боті буде працювати лише одна команда `/id`. 
Котра наддасть вам основну інформацію про ваш профіль, вам потрібен лише ваш телеграм id його потрібно вписати на натиснути на кнопку “**Add**” це добавить ваш id у список “білих” юзерів  (“**White List ID**”) котрих бот не буде ігнорувати. Далі потрібно боту потрібно відправити команду `/start`. 



![Вигляд вікна](https://github.com/MaksBerkutov/MyAsistentNew/blob/master/ImageGit/Settings_TBot.png)
![Вигляд боту](https://github.com/MaksBerkutov/MyAsistentNew/blob/master/ImageGit/Settings_TBot1.png)

- Вкладка “**Емуляція команд**” дозволяє виповнити певну послідовність дій назначену на команду тріггер.

![Вигляд боту](https://github.com/MaksBerkutov/MyAsistentNew/blob/master/ImageGit/Settings_TBot2.png)

Для цього потрібно натиснути на команду котру треба зімітувати.
- Вкладка “**Базова інформація**” містить інформацію про сервер.
- 
![Базова інформація боту](https://github.com/MaksBerkutov/MyAsistentNew/blob/master/ImageGit/Settings_TBot3.png)


Кнопка “**Получить все логи**” в результаті ви отримаєте весь журнал з серверу.

![Базова інформація боту](https://github.com/MaksBerkutov/MyAsistentNew/blob/master/ImageGit/Settings_TBot4.png)
